<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<head>
  <title>The Philosopher Developer</title>
  <meta content='initial-scale=1.0, width=device-width, user-scalable=no' name='viewport' />
  <link href='/stylesheets/application.css' rel='stylesheet' />
  <link href='/stylesheets/pygments.css' rel='stylesheet' />
  <script src='/javascripts/ga.js' type='text/javascript'></script>
</head>
<body>
  <div id='header'>
    <h1><a href="/">The Philosopher Developer</a></h1>
    <h2>half-sound logic, half-decent code</h2>
  </div>
  <article class='post'>
  <section class='heading'>
    <h1>
      <span class='title'>
        <a href='/posts/unbreaking-datamapper.html'>Unbreaking DataMapper</a>
      </span>
      <span class='date'>January 28, 2013</span>
    </h1>
  </section>
  <section class='content'>
    <h2 id="is_datamapper_inherently_broken_1">Is DataMapper inherently broken?</h2>

<p>In a <a href="http://www.drmaciver.com/2010/04/datamapper-is-inherently-broken/">strongly-worded blog post back in 2010</a>, David MacIver asserted that there is fundamental flaw in <a href="http://datamapper.org/">DataMapper</a>, an ORM library for Ruby. The core of his complaint is<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup> that DataMapper’s default API for saving records hides errors, making it difficult to diagnose what went wrong when something fails. This in turn increases the likelihood of defects slipping unnoticed through testing, resulting in buggier software.</p>

<p>Borrowing from MacIver’s post<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>, the below is a boilerplate example of how one might attempt to save a record and report any failures using DataMapper:</p>

<div class="highlight"><pre><span class="n">my_account</span> <span class="o">=</span> <span class="no">Account</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s2">"Jose"</span><span class="p">)</span>
<span class="k">if</span> <span class="n">my_account</span><span class="o">.</span><span class="n">save</span>
  <span class="c1"># my_account is valid and has been saved</span>
<span class="k">else</span>
  <span class="n">my_account</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">e</span><span class="o">|</span>
    <span class="nb">puts</span> <span class="n">e</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>

<p>The above can be pretty annoying to anyone who expects conciseness from an API. Most developers don’t like the idea of having to write several lines of code just to save a record to a database.</p>

<p>Why not wrap the above into a common helper? This still won’t consistently work, as MacIvers points out with the following example:</p>

<div class="highlight"><pre><span class="n">my_account</span> <span class="o">=</span> <span class="no">Account</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="ss">:customer</span> <span class="o">=&gt;</span> <span class="no">Customer</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s2">"jose"</span><span class="p">))</span>
<span class="n">my_account</span><span class="o">.</span><span class="n">save</span>
</pre></div>

<p>In this case, an error could occur when saving <em>either</em> the <code>Account</code> object <em>or</em> the <code>Customer</code> object. And so a general-purpose helper wouldn’t be enough; one would have to write a special helper for every model, accounting for each of that model’s associations, in every application.</p>

<p>I certainly sympathize with MacIver’s frustration.</p>

<h2 id="why_use_datamapper_at_all_then_2">Why use DataMapper at all, then?</h2>

<p>It’s really a shame that such a “fundamental flaw”<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup> exists in DataMapper. Otherwise, I find it to be quite a nice ORM, with at least a couple of (admittedly subjective) advantages over the more popular <a href="https://github.com/rails/rails/tree/master/activerecord">ActiveRecord</a>:</p>

<ol><li>With DataMapper, your database schema is defined in your models themselves. The ActiveRecord approach uses a <span class="post-link">... (<a href="/posts/unbreaking-datamapper.html">read the full post</a>)</span>
</li></ol>
  </section>
</article>
<article class='post'>
  <section class='heading'>
    <h1>
      <span class='title'>
        <a href='/posts/making-yaml-safe-again.html'>Making YAML safe again</a>
      </span>
      <span class='date'>January 24, 2013</span>
    </h1>
  </section>
  <section class='content'>
    <p>TL;DR: Check out my new gem, <a href="http://dtao.github.com/safe_yaml">SafeYAML</a>. It lets you parse YAML without exposing your app to security exploits via arbitrary object deserialization.</p>
<hr><p>There was <a href="http://news.ycombinator.com/item?id=5028218">quite a stir in the Rails community recently</a> about a serious security vulnerability in Rails. To be more specific: <a href="https://groups.google.com/forum/#!topic/rubyonrails-security/61bkgvnSGTQ/discussion"><em>every version of Rails</em></a>. We found out about this right away at <a href="http://www.cardpool.com/">Cardpool</a>, in part because Cardpool is a YC company and Paul Graham forwarded an e-mail from Thomas Ptacek to all YC alums warning of the vulnerability pretty much as soon as it was discovered.</p>

<p>Without getting too caught up in the weeds, I will just say the vulnerability was ultimately a consequence of the fact that Ruby’s <a href="http://www.yaml.org/">YAML</a> library by default permits the deserialization of arbitrary Ruby objects. This is a problem for Rails—as well as many other Ruby frameworks, to be fair—because, until patches were released to address this problem, any Rails app could be “tricked” into parsing malicious YAML by basically anybody, without any special credentials. The key weakness in Rails, specifically, was that Rails would automatically parse the parameters of any XML request, including parameters like this:</p>

<div class="highlight"><pre><span class="nt">&lt;data</span> <span class="na">type=</span><span class="s">"yaml"</span><span class="nt">&gt;</span>--- !ruby/object {}<span class="nt">&lt;/data&gt;</span>
</pre></div>

<p>I’m not giving anything away here; exploits <a href="https://community.rapid7.com/community/metasploit/blog/2013/01/09/serialization-mischief-in-ruby-land-cve-2013-0156">have already been made public</a>. The important takeaway is pretty simple: never parse YAML from untrusted user input. Not in an application, and <em>definitely</em> not in a framework. Which means, in the case of Rails, don’t automatically parse params as YAML. The patches that were released (and which we quickly deployed, obviously) addressed this issue by disabling XML parameter parsing by default. (Less aggressive patches were also made available for sites that needed to parse XML params by simply removing YAML from the list of types that could be embedded in an XML request.)</p>

<p>While this is probably fine <span class="post-link">... (<a href="/posts/making-yaml-safe-again.html">read the full post</a>)</span></p>
  </section>
</article>
<article class='post'>
  <section class='heading'>
    <h1>
      <span class='title'>
        <a href='/posts/ab-testing-and-irreducible-complexity.html'>A/B testing and irreducible complexity</a>
      </span>
      <span class='date'>January 13, 2013</span>
    </h1>
  </section>
  <section class='content'>
    <p>I was raised in a devout Christian family, which resulted in a fair amount of inner conflict and soul-searching throughout my academic life, <em>particularly</em> with respect to my ninth-grade education on evolution<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>. This in turn ultimately led me to read a book called <a href="http://www.amazon.com/Darwins-Black-Box-Biochemical-Challenge/dp/0743290313">Darwin’s Black Box</a> by Michael Behe, which argues in favor of <a href="http://en.wikipedia.org/wiki/Intelligent_design">intelligent design</a><sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup> on the basis of a concept called <a href="http://en.wikipedia.org/wiki/Irreducible_complexity"><strong>irreducible complexity</strong></a>. It is actually a pretty reasonable argument, in my opinion—though I’m admittedly no expert on the subject—at least in that its premise seems plausible. To summarize in one sentence: Behe argues that there are systems in present-day organisms consisting of interacting parts, each of which on its own would provide no reproductive advantage to an individual and so cannot be explained purely by Darwinian natural selection. Only taken <em>as a whole</em> do these systems provide reproductive advantages; and so some other process must have generated them (where intelligent design enters the picture).</p>

<p>Behe provides plenty of low-level biochemical examples that I won’t bother you with, primarily because I don’t remember them. But whether or not you agree with his argument—and my limited research leads me to believe that (surprise!) most of the scientific community does <strong>not</strong>–I think the <em>concept</em> of irreducible complexity is a useful one. Even if Behe is wrong with respect to evolution, we all know and probably to some extent accept the idea behind <em>the whole is greater than the sum of its parts</em>. Not everything in this world is the end result of some sequence of perfectly incremental changes, each coherent and explicable in its own right. Morever, if a whole could be greater than the sum of its parts, this leaves open the possibility that any given part on its own could even have <span class="post-link">... (<a href="/posts/ab-testing-and-irreducible-complexity.html">read the full post</a>)</span></p>
  </section>
</article>
<article class='post'>
  <section class='heading'>
    <h1>
      <span class='title'>
        <a href='/posts/optimize-for-comprehensibility.html'>Optimize for comprehensibility</a>
      </span>
      <span class='date'>December 29, 2012</span>
    </h1>
  </section>
  <section class='content'>
    <h1 id="starting_with_an_outline_1">Starting with an outline</h1>

<p>More than one of my high school English teachers taught us that when you’re writing a paper, you should start by making an outline of your high-level points. This way, they told us, you would have a “skeleton” paper already written, which you could then “flesh out” by filling in appropriate details here and there.</p>

<p>I never much internalized this process of starting off with an outline. I wish I had.</p>

<h1 id="to_design_or_assemble_2">To design or assemble</h1>

<p>My first project at <a href="http://www.thoughtworks.com/">ThoughtWorks</a> was in Dallas, TX. During a car ride back to the office after lunch one day, I was having a conversation with Billy, one of the client company’s developers; and he mentioned that he had recently been to a Google conference to learn about <a href="https://developers.google.com/web-toolkit/">Google Web Toolkit</a> (one of the technologies we were using on the project), among other things. I can’t recall everything we talked about, but something that Billy said during that conversation has stuck with me ever since:</p>

<blockquote>
<p>Companies like Google, Microsoft, Apple—they are the LEGO makers. We are just the assemblers.</p>
</blockquote>

<p>At the time, I strongly disagreed with Billy on this point. Part of me wanted to blurt out, “Speak for yourself!” I didn’t say that, of course; in fact I wasn’t even sure why I felt so strongly in opposition to this statement. Probably more than any other reason, I was just feeling defensive against what I felt was a belittling thing to say about being a software developer.</p>

<p>What I <em>did</em> say was something to the effect that we are all LEGO makers in the sense that we should strive to write clean code, to design clear interfaces, to build reusable components, etc. Billy smiled but clearly didn’t agree with me. In retrospect, he probably thought I was being naïve.</p> <span class="post-link">... (<a href="/posts/optimize-for-comprehensibility.html">read the full post</a>)</span>
  </section>
</article>
<article class='post'>
  <section class='heading'>
    <h1>
      <span class='title'>
        <a href='/posts/universe-is-a-one-way-function.html'>The universe is a one-way function</a>
      </span>
      <span class='date'>October 03, 2012</span>
    </h1>
  </section>
  <section class='content'>
    <p>Recently my friend Chuck reminded me of a conversation he and I had ages ago about a company called <a href="http://steorn.com/">Steorn</a>. This is a company that publicly claimed, back in 2007, to have developed an <a href="http://en.wikipedia.org/wiki/Overunity">overunity</a> technology. Chuck chastised me for having persuaded him to take the company seriously; to this day, despite their refusal to back down, they have still not convincingly <a href="http://en.wikipedia.org/wiki/Second_law_of_thermodynamics">broken the second law of thermodynamics</a>.</p>

<p>Most of my acquaintances with a modest amount of scientific knowledge, of course, dismissed Steorn from the very start. What the company claims to do violates a known law of physics, they argued; therefore it is impossible; therefore they are either lying or confused. Personally, I never did and probably never will fully sympathize with this attitude. While I agree that Steorn probably do not have what they have claimed (and I certainly have no intention of arguing with the laws of thermodynamics!), I disagree with the premise that we can be <em>so sure</em> of things like this that we are justified in rejecting them immediately.</p>

<p>This is actually the same topic I covered in <a href="http://philosopherdeveloper.wordpress.com/2009/12/19/the-myth-of-the-myth-of-perpetual-motion/">my very first post on this blog</a>. But it’s something I feel quite strongly about, so I’ll probably write about it again, and again, until I’m satisfied I’ve fully covered the topic in the way I want (i.e., never). This time around, I want to relate my skepticism<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup> in these sorts of matters to the concept of <em>one-way-functions</em>–a mathematical term that I’ll define later in this post. But first, I’ll start with a simple problem.</p>

<h2 id="recognizing_patterns_1">Recognizing patterns</h2>

<p>Back in the old K–12 days, I remember sometimes taking tests with <em>pattern recognition</em> questions. As a kid, I was always frustrated by these questions because I felt that they generally had no right answer. <span class="post-link">... (<a href="/posts/universe-is-a-one-way-function.html">read the full post</a>)</span></p>
  </section>
</article>
  <div id='footer'>
    <ul class='menu'>
      <li><a href="/posts">All Posts</a></li>
      <li><a href="/about">About</a></li>
      <li>
        <a href='http://stackoverflow.com/users/105570' target='_blank'>
          <img alt='StackOverflow' src='/images/icons/stackoverflow-small.png' />
        </a>
      </li>
      <li>
        <a href='https://github.com/dtao' target='_blank'>
          <img alt='GitHub' src='/images/icons/github-small.png' />
        </a>
      </li>
      <li>
        <a href='https://twitter.com/dan_tao' target='_blank'>
          <img alt='Twitter' src='/images/icons/twitter-small.png' />
        </a>
      </li>
      <li>
        <a href='/rss.xml'>
          <img alt='RSS' src='/images/icons/rss-small.png' />
        </a>
      </li>
    </ul>
  </div>
</body>
