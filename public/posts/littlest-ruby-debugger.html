<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<head>
  <title>The littlest Ruby debugger - The Philosopher Developer</title>
  <meta content='initial-scale=1.0, width=device-width, user-scalable=no' name='viewport' />
  <link href='/stylesheets/application.css' rel='stylesheet' />
  <link href='/stylesheets/pygments.css' rel='stylesheet' />
  <script src='http://w.sharethis.com/button/buttons.js' type='text/javascript'></script>
  <script src='/javascripts/ga.js' type='text/javascript'></script>
  <script src='/javascripts/shareThis.js' type='text/javascript'></script>
  
</head>
<body>
  <header id='header'>
    <h1>
      <a href='/posts/littlest-ruby-debugger.html'>The littlest Ruby debugger</a>
    </h1>
    <h2><a href="/">the philosopher developer</a></h2>
  </header>
  <article>
  <header>
    <h1>March 16, 2012</h1>
    <div class='social'>
      <span class='st_facebook_hcount' displayText='Facebook'></span>
      <span class='st_googleplus_hcount' displayText='Google+'></span>
      <span class='st_twitter_hcount' displayText='Tweet'></span>
      <span class='st_linkedin_hcount' displayText='LinkedIn'></span>
    </div>
  </header>
  <section class='content'>
    <p>It is a well-known fact among my teammates that my tolerance for hacks is higher than most developers’. And so it is that sometimes I write code that others find horrifying.</p>

<p>Here’s one that I personally like, and which has caused more than one of my teammates to chuckle in half-approval. It came up again just today, as we are using <a href="http://www.padrinorb.com/">Padrino</a> on my current project and a coworker wanted to know if Sinatra and/or Padrino had an equivalent to the Rails console (to allow a dev to poke around the system at some arbitrary point during the program’s execution—say, in the middle of handling a request at the controller level).</p>

<p>Frankly, I’m no Sinatra expert. For all I know there <em>is</em><sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup> an equivalent to the Rails console in Sinatra. I’ve never really cared, because if I want to poke around the code mid-request I just whip up something like this, which I shall call the <strong>littlest Ruby debugger</strong>:</p>

<div class="highlight"><pre><span class="nb">puts</span> <span class="s2">"Start typing away."</span>
<span class="k">while</span> <span class="p">(</span><span class="n">line</span> <span class="o">=</span> <span class="no">STDIN</span><span class="o">.</span><span class="n">readline</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span> <span class="o">!=</span> <span class="s2">""</span>
  <span class="nb">puts</span> <span class="nb">eval</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>

<p>Yes, yes, I know. Any developer who lets something like that slip into production code deserves to be shot. But I would honestly argue that the chances of that are so close to zero as to be completely unworthy of any serious consideration.</p>

<p>Here’s an example of the above hack in action, responding to a request on my local machine (with my commands highlighted):</p>
<pre>  DEBUG -      GET (0.0120ms) /layouts/ - 200
0:0:0:0:0:0:0:1%0 - - [16/Mar/2012 16:22:44] "GET /layouts/ HTTP/1.1" 200 - 0.0160
Start typing away.
<span class="highlight-special">params.inspect</span>
{:layout_id=&gt;"1"}
<span class="highlight-special">params[:layout_id]</span>
1
<span class="highlight-special">self.methods.select { |m| m.start_with?("c") }</span>
current_user
cache_action
check_box_tag
content_tag
content_for
concat_content
content_for?
concat
capture_html
capture
content_blocks
content_type
current_engine
current_path
call!
call
coffee
creole
cache_control
client_error?
com
class
clone
class_eval

  DEBUG - TEMPLATE (0.0010ms) /layouts/application
  DEBUG -      GET (24.3990ms) /layouts/1 - 200
0:0:0:0:0:0:0:1%0 - - [16/Mar/2012 16:23:12] "GET /layouts/1 HTTP/1.1" 200 - 24.4020</pre>
<p>See, this is why you want people like me on your team. Otherwise, who’s going to hack up your code base?</p>
<div class="footnotes">
<hr>
<ol><li id="fn:1">
<p>As it happens, there absolutely is an equivalent, at least in Padrino: <code>padrino console</code>. However, this isn’t really the same as what I’ve described here, which is more analogous to calling <code>debugger</code> in the middle of a controller action in Rails. <a href="#fnref:1" rev="footnote">↩</a></p>
</li></ol>
</div>
  </section>
  <section class='comments'>
    <div id='disqus_thread'></div>
    <script src='/javascripts/disqus.js' type='text/javascript'></script>
    <noscript>
      Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
    </noscript>
    <a class='dsq-brlink' href='http://disqus.com'>
      comments powered by
      <span class='logo-disqus'>Disqus</span>
    </a>
  </section>
</article>
  <footer>
    <ul class='menu'>
      <li><a href="/posts">All Posts</a></li>
      <li><a href="/about">About</a></li>
      <li>
        <a href='http://stackoverflow.com/users/105570' target='_blank'>
          <img alt='StackOverflow' src='/images/icons/stackoverflow-small.png' />
        </a>
      </li>
      <li>
        <a href='https://github.com/dtao' target='_blank'>
          <img alt='GitHub' src='/images/icons/github-small.png' />
        </a>
      </li>
      <li>
        <a href='https://twitter.com/dan_tao' target='_blank'>
          <img alt='Twitter' src='/images/icons/twitter-small.png' />
        </a>
      </li>
      <li>
        <a href='http://feeds.feedburner.com/philosopherdeveloper'>
          <img alt='RSS' src='/images/icons/rss-small.png' />
        </a>
      </li>
    </ul>
  </footer>
</body>
